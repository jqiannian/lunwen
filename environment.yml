# 单一事实源（SSOT）：Conda 环境定义
#
# 创建环境：conda env create -f environment.yml
# 更新环境：conda env update -f environment.yml --prune
# 激活环境：conda activate traffic-rules
#
# 说明：本项目依赖以 conda-forge 为主；仅当 conda-forge 无法满足时才使用 pip:
# - 运行/训练/测试产物：artifacts/ 与 reports/

name: traffic-rules
channels:
  - conda-forge

dependencies:
  - python=3.12

  # 核心科学计算
  - numpy>=1.26,<2.0
  - pandas>=2.2,<3.0
  - scipy>=1.13,<2.0

  # 深度学习（CPU/macOS）
  # 备注：如需 CUDA，请在后续环境文件中单独维护（避免混入 mac 环境）
  - pytorch>=2.4,<2.5
  - torchvision>=0.19,<0.20
  - torchaudio>=2.4,<2.5

  # 图/数据
  - networkx>=3.2,<4.0

  # 配置与校验
  - pydantic>=2.7,<3.0
  - pyyaml>=6.0,<7.0

  # 可视化/CLI
  - matplotlib>=3.8,<4.0
  - seaborn>=0.13,<0.14
  - rich>=13.7,<14.0
  - tqdm>=4.66,<5.0
  - typer>=0.12,<1.0

  # 监控与日志
  - prometheus_client>=0.20,<1.0
  - structlog>=24.1,<25.0

  # 计算机视觉
  - opencv>=4.9,<5.0

  # 基础工具
  - pip

  # pip 兜底（仅当 conda-forge 无对应包时才加）
  - pip:
      []
