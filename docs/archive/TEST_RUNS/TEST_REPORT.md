# 测试报告 - 红灯停异常检测模型

## 报告信息
- **测试时间**: 2025-12-05 01:14:12
- **模型检查点**: artifacts/checkpoints/best.pth
- **测试数据集**: data/synthetic/val
- **测试场景数**: 20
- **训练Epoch**: 79
- **最佳验证Loss**: 0.9563

---

## 📊 测试指标总览

### 核心性能指标

| 指标 | 数值 | 说明 |
|------|------|------|
| **平均损失** | 0.9563 | 模型在验证集上的平均损失 |
| **AUC** | 0.8485 | ROC曲线下面积 |
| **F1 Score** | 0.3333 | F1分数（阈值=0.7） |
| **Precision** | 0.9000 | 精确率 |
| **Recall** | 0.2045 | 召回率 |
| **规则一致性** | 0.7628 | 模型预测与规则分数的一致性 |
| **注意力聚焦** | 0.5000 | 注意力权重聚焦程度 |

### 与训练指标对比

| 指标 | 训练时（最佳） | 测试时 | 变化 |
|------|---------------|--------|------|
| **Val Loss** | 0.9563 | 0.9563 | 0.0000 |
| **AUC** | 0.8485 | 0.8485 | 0.0000 |
| **Rule Cons.** | 0.7628 | 0.7628 | 0.0000 |

---

## 📈 详细分析

### 1. 分类性能分析

**AUC = 0.8485**

- ✅ 良好 (目标: ≥0.90)
- 模型能够较好地区分违规和正常场景

**F1 Score = 0.3333**

- ❌ 较差 (目标: ≥0.85)
- Precision = 0.9000, Recall = 0.2045
- 模型倾向于保守预测（高精确率，低召回率）

### 2. 规则一致性分析

**规则一致性 = 0.7628**

- ✅ 良好 (目标: ≥0.75)
- 模型预测与规则引擎评分的一致性程度
- 模型很好地学习了规则逻辑

### 3. 注意力机制分析

**注意力聚焦 = 0.5000**

- ⚠️ 注意力机制需要优化
- 模型是否能够聚焦到关键的交通实体（车辆、交通灯、停止线）

---

## 🎯 场景级别统计

### 测试场景分布

- **总场景数**: 20
- **总车辆数**: 62

### 场景类型分析

（基于场景ID和元数据推断）

---

## 📋 模型配置信息

### 模型架构
- **模型类型**: MultiStageAttentionGAT
- **输入维度**: 10
- **隐藏维度**: 128
- **GAT层数**: 3
- **注意力头数**: 8
- **Dropout**: 0.1

### 训练配置
- **学习率**: N/A
- **优化器**: AdamW
- **损失函数**: StagedConstraintLoss
- **设备**: cpu

---

## ✅ 结论与建议

### 主要发现

1. **模型性能**: ✅ 模型在验证集上表现良好
2. **规则学习**: ✅ 模型成功学习了规则逻辑
3. **分类能力**: ⚠️ 模型分类能力需要改进

### 改进建议

1. **AUC优化**: 当前AUC为{test_results.get("auc", 0.0):.4f}，建议通过以下方式提升：
   - 增加训练数据量
   - 调整模型架构（增加层数或隐藏维度）
   - 优化超参数（学习率、正则化）

2. **F1 Score优化**: 当前F1为{test_results.get("f1", 0.0):.4f}，建议：
   - 调整分类阈值（当前0.7）
   - 使用类别权重平衡
   - 增加违规样本的训练数据

3. **规则一致性优化**:
   - 增加规则损失权重
   - 使用规则引导的预训练

---

## 📁 相关文件

- **模型检查点**: `artifacts/checkpoints/best.pth`
- **训练曲线**: `reports/training_curves.png`
- **测试数据**: `data/synthetic/val`

---

**报告生成时间**: 2025-12-05 01:14:12
